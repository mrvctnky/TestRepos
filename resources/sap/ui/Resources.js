/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/base/assert','sap/base/Log','sap/base/strings/formatMessage','sap/base/util/extend','sap/ui/Properties'],function(a,L,f,e,P){"use strict";var r=/^((?:[A-Z]{2,3}(?:-[A-Z]{3}){0,3})|[A-Z]{4}|[A-Z]{5,8})(?:-([A-Z]{4}))?(?:-([A-Z]{2}|[0-9]{3}))?((?:-[0-9A-Z]{5,8}|-[0-9][0-9A-Z]{3})*)((?:-[0-9A-WYZ](?:-[0-9A-Z]{2,8})+)*)(?:-(X(?:-[0-9A-Z]{1,8})+))?$/i;var M={"he":"iw","yi":"ji","id":"in","sr":"sh"};var b={"iw":"he","ji":"yi","in":"id","sh":"sr"};var c={"en_US_saptrc":"1Q","en_US_sappsd":"2Q"};var d=/(?:^|-)(saptrc|sappsd)(?:-|$)/i;function n(i){var m;if(typeof i==='string'&&(m=r.exec(i.replace(/_/g,'-')))){var p=m[1].toLowerCase();p=M[p]||p;var S=m[2]?m[2].toLowerCase():undefined;var u=m[3]?m[3].toUpperCase():undefined;var v=m[4]?m[4].slice(1):undefined;var w=m[6];if((w&&(m=d.exec(w)))||(v&&(m=d.exec(v)))){return"en_US_"+m[1].toLowerCase();}if(p==="zh"&&!u){if(S==="hans"){u="CN";}else if(S==="hant"){u="TW";}}return p+(u?"_"+u+(v?"_"+v.replace("-","_"):""):"");}}function g(){var i;if(window.sap&&window.sap.ui&&sap.ui.getCore){i=sap.ui.getCore().getConfiguration().getLanguage();i=n(i);}return i||"en";}function h(i){if(!i){return null;}if(i==="zh_HK"){return"zh_TW";}var p=i.lastIndexOf('_');if(p>=0){return i.slice(0,p);}return i!=='en'?'en':'';}function j(i){var m;if(typeof i==='string'&&(m=r.exec(i.replace(/_/g,'-')))){var p=m[1].toLowerCase();p=b[p]||p;return p+(m[3]?"-"+m[3].toUpperCase()+(m[4]?"-"+m[4].slice(1).replace("_","-"):""):"");}}var k=/^((?:[^?#]*\/)?[^\/?#]*)(\.[^.\/?#]+)((?:\?([^#]*))?(?:#(.*))?)$/;var A=[".properties",".hdbtextbundle"];function s(u){var m=k.exec(u);if(!m||A.indexOf(m[2])<0){throw new Error("resource URL '"+u+"' has unknown type (should be one of "+A.join(",")+")");}return{url:u,prefix:m[1],ext:m[2],query:m[4],hash:(m[5]||""),suffix:m[2]+(m[3]||"")};}function B(u,i,I,m){this.sLocale=this._sNextLocale=n(i)||g();this.oUrlInfo=s(u);this.bIncludeInfo=I;this.aCustomBundles=[];this.aPropertyFiles=[];this.aLocales=[];if(m){var p=function(){return this;}.bind(this);return l(this).then(p,p);}o(this);}B.prototype._enhance=function(C){if(C instanceof B){this.aCustomBundles.push(C);}else{L.error("Custom resource bundle is either undefined or not an instanceof sap/ui/Resources/Bundle. Therefore this custom resource bundle will be ignored!");}};B.prototype.getText=function(K,m,C){var v=null,i;for(i=this.aCustomBundles.length-1;i>=0;i--){v=this.aCustomBundles[i].getText(K,m,true);if(v!=null){return v;}}for(i=0;i<this.aPropertyFiles.length;i++){v=this.aPropertyFiles[i].getProperty(K);if(typeof v==="string"){break;}}while(typeof v!=="string"&&this._sNextLocale!=null){var p=o(this);if(p){v=p.getProperty(K);}}if(!C&&typeof v!=="string"){a(false,"could not find any translatable text for key '"+K+"' in bundle '"+this.oUrlInfo.url+"'");v=K;}if(typeof v==="string"){if(m){v=f(v,m);}if(this.bIncludeInfo){v=new String(v);v.originInfo={source:"Resource Bundle",url:this.oUrlInfo.url,locale:this.sLocale,key:K};}}return v;};B.prototype.hasText=function(K){return this.aPropertyFiles.length>0&&typeof this.aPropertyFiles[0].getProperty(K)==="string";};function l(i){if(i._sNextLocale!=null){return t(i,true).then(function(p){return p||l(i);});}return Promise.resolve(null);}function o(i){while(i._sNextLocale!=null){var p=t(i,false);if(p){return p;}}return null;}function q(i,S){return!S||S.length===0||S.indexOf(i)>=0;}function t(i,m){var p=i._sNextLocale;i._sNextLocale=h(p);var S=window.sap&&window.sap.ui&&sap.ui.getCore&&sap.ui.getCore().getConfiguration().getSupportedLanguages();if(p!=null&&q(p,S)){var u=i.oUrlInfo,U,H;if(u.ext==='.hdbtextbundle'){if(c[p]){U=u.prefix+u.suffix+'?'+(u.query?u.query+"&":"")+"sap-language="+c[p]+(u.hash?"#"+u.hash:"");}else{U=u.url;}H={"Accept-Language":j(p)||""};}else{U=u.prefix+(p?"_"+p:"")+u.suffix;}var v=P({url:U,headers:H,async:!!m,returnNullIfMissing:true});var w=function(x){if(x){i.aPropertyFiles.push(x);i.aLocales.push(p);}return x;};return m?v.then(w):w(v);}return m?Promise.resolve(null):null;}var R=function resources(p){p=e({url:"",locale:undefined,includeInfo:false},p);return new B(p.url,p.locale,p.includeInfo,!!p.async);};R.isBundle=function(i){return i instanceof B;};R._getFallbackLocales=function(i,S){var T=n(i),m=[];while(T!=null){if(q(T,S)){m.push(T);}T=h(T);}return m;};return R;});
