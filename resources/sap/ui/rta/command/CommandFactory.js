/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/base/ManagedObject','sap/ui/dt/ElementUtil','sap/ui/dt/OverlayRegistry','sap/ui/fl/registry/ChangeRegistry','sap/ui/fl/Utils'],function(M,E,O,C,F){"use strict";function c(o,l,A){var s;var J=false;if(typeof(A)==="string"){s=A;}else{s=A&&A.changeType;J=A&&A.jsOnly;}if(!s){return false;}l.setChangeType(s);l.setJsOnly(J);return true;}function a(o,s,D){var A={changeType:"addXML"};if(D){jQuery.extend(A,D.getAction("addXML",o));}return A;}function b(o,s,D){var n=s.element||sap.ui.getCore().byId(s.element.id);var A=D.getActionDataFromAggregations("createContainer",n)[0];return A;}function d(o,s,D){var l=s.movedElements[0].element||sap.ui.getCore().byId(s.movedElements[0].id);var A=D.getAction("move",l);if(!A&&D.getMetadata().getName()==="sap.ui.dt.ElementDesignTimeMetadata"){A=D.getActionDataFromAggregations("move",o).filter(function(n){return n.aggregation===s.source.aggregation;})[0];}return A;}function e(o,s,D){var r=s.renamedElement;var A=D.getAction("rename",r);return A;}function f(o,s,D){var r=s.removedElement;if(!r){r=o;}else if(!(r instanceof M)){throw new Error("No valid 'removedElement' found");}var A=D.getAction("remove",r);return A;}function g(o,s,D){var l=s.source;var A=D.getAction("combine",l);return A;}function h(o,s,D){var S=s.source;var A=D.getAction("split",S);return A;}function i(o,s,D){var n=s.element;var A=D.getAction("addODataProperty",n);return A;}function j(o,s,D){var r=s.directParent;var A=D.getAction("reveal",r);return A;}var m={"composite":{clazz:'sap.ui.rta.command.CompositeCommand'},"property":{clazz:'sap.ui.rta.command.Property'},"bindProperty":{clazz:'sap.ui.rta.command.BindProperty'},"addXML":{clazz:'sap.ui.rta.command.AddXML',configure:a},"createContainer":{clazz:'sap.ui.rta.command.CreateContainer',configure:b},"move":{clazz:'sap.ui.rta.command.Move',configure:d},"remove":{clazz:'sap.ui.rta.command.Remove',configure:f},"rename":{clazz:'sap.ui.rta.command.Rename',configure:e},"addODataProperty":{clazz:'sap.ui.rta.command.AddODataProperty',configure:i},"reveal":{clazz:'sap.ui.rta.command.Reveal',configure:j},"combine":{clazz:'sap.ui.rta.command.Combine',configure:g},"split":{clazz:'sap.ui.rta.command.Split',configure:h},"switch":{clazz:'sap.ui.rta.command.ControlVariantSwitch'},"duplicate":{clazz:'sap.ui.rta.command.ControlVariantDuplicate'},"setTitle":{clazz:'sap.ui.rta.command.ControlVariantSetTitle'},"configure":{clazz:'sap.ui.rta.command.ControlVariantConfigure'},"settings":{clazz:'sap.ui.rta.command.Settings'},"addLibrary":{clazz:'sap.ui.rta.command.appDescriptor.AddLibrary'},"appDescriptor":{clazz:'sap.ui.rta.command.AppDescriptorCommand'}};function _(v,s,S,D,l,V){s=s[0].toLowerCase()+s.slice(1);var n=m[s];if(!n){throw new Error("Command '"+s+"' doesn't exist, check typing");}var o=n.clazz;jQuery.sap.require(o);var p=jQuery.sap.getObject(o);var I=v instanceof sap.ui.base.ManagedObject;S=jQuery.extend(S,{element:I?v:undefined,selector:I?undefined:v,name:s});var A;if(n.configure){A=n.configure(v,S,D);}var q;if(A&&A.changeOnRelevantContainer){q=O.getOverlay(v);S=jQuery.extend(S,{element:q.getRelevantContainer()});v=S.element;}var r=new p(S);var t=true;if(n.configure){t=c(v,r,A);}var P=t&&r.prepare(l,V);if(P){return r;}else{r.destroy();return undefined;}}var k=M.extend("sap.ui.rta.command.CommandFactory",{metadata:{library:"sap.ui.rta",properties:{"flexSettings":{type:"object"}},associations:{},events:{}}});k.prototype.init=function(){this.setProperty("flexSettings",{layer:"CUSTOMER",developerMode:true});};k.prototype.setFlexSettings=function(l){this.setProperty("flexSettings",jQuery.extend(this.getFlexSettings(),l));};k.prototype.getCommandFor=function(v,s,S,D,V){return _(v,s,S,D,this.getFlexSettings(),V);};k.getCommandFor=function(v,s,S,D,l){if(!l){l={layer:"CUSTOMER",developerMode:true};}if(l.scenario||l.baseId){var L=F.buildLrepRootNamespace(l.baseId,l.scenario,l.projectId);l.rootNamespace=L;l.namespace=L+"changes/";}return _(v,s,S,D,l);};return k;},true);
